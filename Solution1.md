### Task 1：成本-工期基准模型

#### 1. 思路
建立三种运输场景 A/B/C 的 $(C, T)$：
* 先用物理/运力关系得到工期 $T$；
* 再用成本口径得到总成本 $C$；
* 用 **AHP** 给出"成本 vs 工期"的偏好权重（本题取 $a=5$）；
* 场景B使用 **0-1规划（枚举法）** 优化基地选择；
* 用 **TOPSIS** 对三种场景的 $(C, T)$ 做综合排序。

#### 2. 全局假设与符号
* 完美运行：无故障、无运力折减。
* 总运输量：$M = 10^8$ t。
* 评价指标：成本 $C$（越小越好）、工期 $T$（越小越好）。
* 起始年份：2050年。

#### 3. 权重：AHP（取 $a=5$）
只含两个指标 $\{C, T\}$，判断矩阵取：
$$A=\begin{bmatrix}1 & 1/a\\ a & 1\end{bmatrix},\quad a=5$$
得到权重（特征向量归一化，等价于 $[1, a]$ 归一化）：
$$\omega_C = \frac{1}{1+a}=\frac{1}{6}\approx 0.167,\quad \omega_T = \frac{a}{1+a}=\frac{5}{6}\approx 0.833$$
选择理由：建设任务对工期敏感（更重视按期完成），因此设置"时间显著重要于成本"。

#### 4. 成本参数定义

**电梯路线（地球港口 → 锚点 → 月球）：**
* 地球港口 → 锚点（100,000 km爬升）：忽略电力成本（近似为0）
* 锚点 → 月球转运火箭：$c_{E,transfer} = 92.7$ USD/kg $= 92,700$ USD/t
* **电梯路线总单位成本**：$$c_E = 92,700 \text{ USD/t}$$

**火箭路线（地球发射场 → 月球）：**
* 基于猎鹰重型（Falcon Heavy）的直达运输
* **火箭路线单位成本**：$$c_R = 1,500 \text{ USD/kg} = 1,500,000 \text{ USD/t}$$

**成本对比：** 电梯路线成本约为火箭路线的 **6.2%**（$92,700 / 1,500,000 \approx 0.062$）

#### 5. 场景 A：仅太空电梯（3 个银河港口）

**参数（题面 + 设定）：**
* 港口数：$N_E=3$
* 单港口年运力：$Q_E=1.79\times 10^5$ t/年
* 电梯单位运输成本：$c_E = 92,700$ USD/t
* 电梯年固定维护费：$C_{E,f}=3\times 10^9$ USD/年/港口（30 亿美元/年）

**工期：**
$$Q_{E,total}=N_E Q_E=3 \times 1.79 \times 10^5 = 5.37 \times 10^5 \text{ t/年}$$
$$T_A=\frac{M}{Q_{E,total}}=\frac{10^8}{5.37 \times 10^5} \approx 186.2 \text{ 年}$$

**成本：**
$$C_A=\underbrace{N_E\, C_{E,f}\, T_A}_{\text{固定维护费}}+\underbrace{M \cdot c_E}_{\text{转运可变成本}}$$
$$C_A = 3 \times 3 \times 10^9 \times 186.2 + 10^8 \times 92,700$$
$$C_A \approx 1.68 \times 10^{12} + 9.27 \times 10^{12} = 1.095 \times 10^{13} \text{ USD (约10.95万亿)}$$

#### 6. 场景 B：仅传统火箭（0-1规划优化基地选择）

**建模口径：**
* 从2050年开始，每个发射场由于扩建、国际合作等原因每年最大发射次数增加一个
* 每次发射尽可能装满：$Q_R=150$ t/次（固定载荷）
* 猎鹰重型运价：$$c_R = 1,500,000 \text{ USD/t}$$

**非线性增长模型（含上限约束）：**
设启用的基地集合为 $\mathcal{S}$，则：
* **物理容量上限：** 每个基地年发射次数上限为 $n_{cap} = 200$ 次/年
* **第 $t$ 年基地 $i$ 的年发射次数：** $$n_i(t) = \min(x_{max,i} + t, \, n_{cap})$$
* **达到上限的时间：** $$t_{cap,i} = n_{cap} - x_{max,i}$$

**累计运输质量分段计算：**
对于基地集合 $\mathcal{S}$，设 $t_{cap,min} = \min_{i \in \mathcal{S}} t_{cap,i}$（最早达到上限的基地）

**阶段1：纯二次增长（$0 \le t \le t_{cap,min}$）**
所有基地均在线性增长阶段：
$$S_1(t) = \sum_{i \in \mathcal{S}} \left[ x_{max,i} \cdot t + \frac{t^2}{2} \right] \cdot Q_R$$
$$= \left( \sum_{i \in \mathcal{S}} x_{max,i} \right) Q_R \cdot t + \frac{|\mathcal{S}| Q_R}{2} \cdot t^2$$
$$= Q_{R,0} \cdot t + \frac{g_R}{2} \cdot t^2$$
其中 $Q_{R,0} = \sum_{i \in \mathcal{S}} x_{max,i} \cdot Q_R$，$g_R = |\mathcal{S}| \cdot Q_R$

**阶段2：混合增长（$t > t_{cap,min}$）**
部分基地达到上限后保持恒定，剩余基地继续增长。为简化模型，采用**近似处理**：
* 若 $S_1(t_{cap,min}) < M$，则继续计算后续阶段（分段积分）
* 若所有基地在任务期内都未达到上限，使用阶段1公式即可

**工期求解：**
首先检查是否所有基地在阶段1内完成任务：
$$M_1 = S_1(t_{cap,min}) = Q_{R,0} \cdot t_{cap,min} + \frac{g_R}{2} \cdot t_{cap,min}^2$$

**情况1：** 若 $M_1 \ge M$（阶段1内完成），则由二次方程求解：
$$\frac{g_R}{2} \cdot T_B^2 + Q_{R,0} \cdot T_B - M = 0$$
$$T_B = \frac{-Q_{R,0} + \sqrt{Q_{R,0}^2 + 2 g_R M}}{g_R}$$

**情况2：** 若 $M_1 < M$（需要进入阶段2），则需分段计算（详见代码实现，涉及逐一处理各基地达到上限的时间点）

**成本计算：**
$$C_B=\underbrace{\left(\sum_{i \in \mathcal{S}} C_{R,fixed,i}\right) T_B}_{\text{基地固定维护费}}+\underbrace{M \cdot c_R}_{\text{发射可变成本}}$$

**0-1规划优化目标：**
由于成本（~10¹³ USD）和工期（~10² 年）的量纲差异巨大，直接加权会导致成本项完全主导。因此采用**归一化加权目标**：

设归一化参数：
* $C_{max} = 1.5 \times 10^{14}$ USD（150万亿，最大预期成本）
* $T_{max} = 350$ 年（最大预期工期）

定义目标函数（越小越好）：
$$\text{Obj}(\mathcal{S}) = \omega_C \cdot \frac{C_B(\mathcal{S})}{C_{max}} + \omega_T \cdot \frac{T_B(\mathcal{S})}{T_{max}}$$
$$= \frac{1}{6} \cdot \frac{C_B(\mathcal{S})}{1.5 \times 10^{14}} + \frac{5}{6} \cdot \frac{T_B(\mathcal{S})}{350}$$

**求解方法：枚举法**
* 总共有 $2^{10} - 1 = 1023$ 种非空基地组合
* 对每种组合 $\mathcal{S}$，计算 $C_B(\mathcal{S}), T_B(\mathcal{S}), \text{Obj}(\mathcal{S})$
* 选择使 $\text{Obj}(\mathcal{S})$ 最小的组合 $\mathcal{S}^*$

#### 7. 场景 C：混合运输（电梯 + 火箭并行，同步完工）

设电梯承担比例为 $\alpha$，火箭承担 $1-\alpha$。为避免堆积与短板，令两系统同步完成：
$$T_C=\frac{\alpha M}{Q_{E,total}}=\frac{(1-\alpha)M}{\text{火箭年均运力}}$$

由于火箭运力随时间增长（二次模型），需要求解：
$$\frac{\alpha M}{Q_{E,total}} = T \quad \text{且} \quad Q_{R,0} \cdot T + \frac{g_R}{2} \cdot T^2 = (1-\alpha)M$$

其中火箭系统使用场景B中优化得到的最优基地组合 $\mathcal{S}^*$。

联立求解得：
$$T_C = \frac{-Q_{total,0} + \sqrt{Q_{total,0}^2 + 2 g_R M}}{g_R}$$
其中 $Q_{total,0} = Q_{E,total} + Q_{R,0}$（两系统初始运力之和）

**成本：**
电梯运输质量：$M_E = Q_{E,total} \cdot T_C$
火箭运输质量：$M_R = M - M_E$

$$C_C=\underbrace{N_E C_{E,f} T_C}_{\text{电梯固定}}+\underbrace{\left(\sum_{i \in \mathcal{S}^*} C_{R,fixed,i}\right)T_C}_{\text{火箭固定}}+\underbrace{M_E \cdot c_E + M_R \cdot c_R}_{\text{可变成本}}$$

#### 8. 评价：TOPSIS（只用 C、T 两指标）

对 A/B/C 的结果组成决策矩阵：
$$X=\begin{bmatrix}C_A & T_A\\ C_B & T_B\\ C_C & T_C\end{bmatrix}$$

步骤：
1. **向量归一化**：$$r_{ij} = \frac{x_{ij}}{\sqrt{\sum_{k=1}^3 x_{kj}^2}}$$
2. **加权归一化矩阵**：$$v_{ij} = \omega_j \cdot r_{ij}$$
   其中 $\omega_C = 1/6, \omega_T = 5/6$
3. **理想解**（因 $C,T$ 均为越小越好）：
   * 正理想解：$V^+ = (\min v_{iC}, \min v_{iT})$
   * 负理想解：$V^- = (\max v_{iC}, \max v_{iT})$
4. **距离计算**：
   $$D_i^+ = \sqrt{(v_{iC}-v_C^+)^2 + (v_{iT}-v_T^+)^2}$$
   $$D_i^- = \sqrt{(v_{iC}-v_C^-)^2 + (v_{iT}-v_T^-)^2}$$
5. **贴近度**：$$C_i = \frac{D_i^-}{D_i^+ + D_i^-}$$
   $C_i$ 越大，方案越优

---

#### 9. 火箭基地数据（作为 $x_{max,i}$ 与 $C_{R,fixed,i}$）

| 排名 | 发射地点 | 2050年初始发射次数 $x_{max,i}$ | 固定维护费用 $C_{R,fixed,i}$ |
|---|---|---:|---:|
| 1 | 佛罗里达州 (Florida) | 73 + 20 = 93 | 6 亿 USD/年 |
| 2 | 加利福尼亚州 (California) | 34 + 20 = 54 | 3 亿 USD/年 |
| 3 | 太原卫星发射中心 (中国) | 11 + 20 = 31 | 0.02 亿 USD/年 |
| 4 | 玛希亚半岛 (新西兰) | 11 + 20 = 31 | 0.02 亿 USD/年 |
| 5 | 哈萨克斯坦 (Kazakhstan) | 9 + 20 = 29 | 0.68 亿 USD/年 |
| 6 | 法属圭亚那 (French Guiana) | 5 + 20 = 25 | 4 亿 USD/年 |
| 7 | 萨迪什·达万航天中心 (印度) | 5 + 20 = 25 | 0.2 亿 USD/年 |
| 8 | 弗吉尼亚州 (Virginia) | 2 + 20 = 22 | 0.04 亿 USD/年 |
| 9 | 德克萨斯州 (Texas) | 2 + 20 = 22 | 0.6 亿 USD/年 |
| 10 | 阿拉斯加州 (Alaska) | 1 + 20 = 21 | 0.02 亿 USD/年 |

**注：** 2050年基线 = 历史年度平均 + 20 次/年（技术进步假设）

#### 10. 关键建模假设总结

1. **载荷容量**：火箭载荷严格固定为 150 t/次（不随时间增长）
2. **发射频率**：每个启用基地每年增加 1 次发射，但**不超过200次/年的物理上限**
3. **成本结构**：
   * 电梯：固定维护费（9亿/年/系统）+ 锚点转运可变成本（92.7 USD/kg）
   * 火箭：固定维护费（各基地不同）+ 发射可变成本（1500 USD/kg）
4. **优化目标**：归一化加权目标，平衡成本与工期（权重5:1偏向工期）
5. **混合策略**：电梯与火箭同步完工，避免资源闲置

#### 11. 预期结果特征

* **场景A**：成本最低但工期最长（~186年）
* **场景B**：成本极高（火箭单价是电梯的16倍），需优化基地选择
* **场景C**：兼顾速度与成本，预期为TOPSIS最优解
